!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("stellar-sdk"),require("jQuery"));else if("function"==typeof define&&define.amd)define(["stellar-sdk","jQuery"],n);else{var t="object"==typeof exports?n(require("stellar-sdk"),require("jQuery")):n(e["stellar-sdk"],e.jQuery);for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}("undefined"!=typeof self?self:this,function(e,n){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=1)}([function(n,t){n.exports=e},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(2),o=t(4);t.d(n,"StellarAPI",function(){return r.a}),t.d(n,"StellarAPIServer",function(){return o.a})},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=t(0),u=t(3),a=function(){function e(n){r(this,e),this._serverAPIServer=n}return o(e,[{key:"server",value:function(){return this._serverAPIServer.server()}},{key:"serverURL",value:function(){return this._serverAPIServer.serverURL()}},{key:"horizonMetrics",value:function(){var e=this.serverURL()+"/metrics";return new Promise(function(n,t){u.get(e,function(e){n(e)},"json").fail(function(e){t(e)})})}},{key:"accountInfo",value:function(e){var n=this;return new Promise(function(t,r){n.server().loadAccount(e).then(function(e){t(e)}).catch(function(e){r(e)})})}},{key:"balances",value:function(e){var n=this;return new Promise(function(t,r){n.server().loadAccount(e).catch(i.NotFoundError,function(e){r(e)}).then(function(e){var n={};return e.balances.forEach(function(e){"native"===e.asset_type?n.XLM=e.balance:n[e.asset_code]=e.balance}),n}).then(function(e){t(e)}).catch(function(e){r(e)})})}},{key:"mergeAccount",value:function(e,n){var t=this;return new Promise(function(r,o){var u=i.Keypair.fromSecret(e);t.server().loadAccount(u.publicKey()).catch(i.NotFoundError,function(e){o(e)}).then(function(e){var r=new i.TransactionBuilder(e).addOperation(i.Operation.accountMerge({destination:n})).build();return r.sign(u),t.server().submitTransaction(r)}).then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"manageOffer",value:function(e,n,t,r,o){var u=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return new Promise(function(c,s){var f=i.Keypair.fromSecret(e);u.server().loadAccount(f.publicKey()).catch(i.NotFoundError,function(e){s(e)}).then(function(e){var c=new i.TransactionBuilder(e).addOperation(i.Operation.manageOffer({selling:t,buying:n,amount:r,price:o,offerId:a})).build();return c.sign(f),u.server().submitTransaction(c)}).then(function(e){c(e)}).catch(function(e){s(e)})})}},{key:"setTrustForAsset",value:function(e,n,t){var r=this;return new Promise(function(o,u){var a=i.Keypair.fromSecret(e);r.server().loadAccount(a.publicKey()).catch(i.NotFoundError,function(e){u(e)}).then(function(e){var o=new i.TransactionBuilder(e).addOperation(i.Operation.changeTrust({asset:n,limit:t})).build();return o.sign(a),r.server().submitTransaction(o)}).then(function(e){o(e)}).catch(function(e){u(e)})})}},{key:"setDomain",value:function(e,n){var t=this;return new Promise(function(r,o){var u=i.Keypair.fromSecret(e);t.server().loadAccount(u.publicKey()).then(function(e){var r=new i.TransactionBuilder(e).addOperation(i.Operation.setOptions({homeDomain:n})).build();return r.sign(u),t.server().submitTransaction(r)}).then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"makeMultiSig",value:function(e,n){var t=this;return new Promise(function(r,o){var u=i.Keypair.fromSecret(e);t.server().loadAccount(u.publicKey()).catch(i.NotFoundError,function(e){o(e)}).then(function(e){var r=new i.TransactionBuilder(e).addOperation(i.Operation.setOptions({signer:{ed25519PublicKey:n,weight:1}})).addOperation(i.Operation.setOptions({masterWeight:1,lowThreshold:1,medThreshold:2,highThreshold:2})).build();return r.sign(u),t.server().submitTransaction(r)}).then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"sendAsset",value:function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return new Promise(function(c,s){var f=i.Keypair.fromSecret(e);o.server().loadAccount(n).catch(i.NotFoundError,function(e){s(e)}).then(function(){return o.server().loadAccount(f.publicKey())}).then(function(e){var c=new i.TransactionBuilder(e).addOperation(i.Operation.payment({destination:n,asset:null===r?i.Asset.native():r,amount:t}));u&&(c=c.addMemo(i.Memo.text(u)));var s=c.build();if(s.sign(f),a){var l=!0,v=!1,d=void 0;try{for(var h,p=a[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var y=h.value;s.sign(i.Keypair.fromSecret(y))}}catch(e){v=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(v)throw d}}}return o.server().submitTransaction(s)}).then(function(e){c(e)}).catch(function(e){s(e)})})}},{key:"hasAssetTrustline",value:function(e,n){return e.balances.some(function(e){return e.asset_code===n.getCode()&&e.asset_issuer===n.getIssuer()})}},{key:"buyTokens",value:function(e,n,t,r,o){var u=this;return new Promise(function(a,c){var s=i.Keypair.fromSecret(e);u.server().loadAccount(s.publicKey()).catch(i.NotFoundError,function(e){c(e)}).then(function(e){if(u.hasAssetTrustline(e,t)){var a=new i.TransactionBuilder(e).addOperation(i.Operation.pathPayment({destination:s.publicKey(),sendAsset:n,sendMax:r,destAsset:t,destAmount:o,path:[]})).build();return a.sign(s),u.server().submitTransaction(a)}c("No trustline from buyer to asset")}).then(function(e){a(e)}).catch(function(e){c(e)})})}},{key:"lockAccount",value:function(e){var n=this;return new Promise(function(t,r){var o={masterWeight:0,lowThreshold:1,medThreshold:1,highThreshold:1};n.setOptions(e,o).then(function(e){t(e)}).catch(function(e){r(e)})})}},{key:"setOptions",value:function(e,n){var t=this;return new Promise(function(r,o){var u=i.Keypair.fromSecret(e);t.server().loadAccount(u.publicKey()).catch(i.NotFoundError,function(e){o(e)}).then(function(e){var r=new i.TransactionBuilder(e).addOperation(i.Operation.setOptions(n)).build();return r.sign(u),t.server().submitTransaction(r)}).then(function(e){r(e)}).catch(function(e){o(e)})})}},{key:"test",value:function(){var e=new i.Asset("LMB","GCYQSB3UQDSISB5LKAL2OEVLAYJNIR7LFVYDNKRMLWQKDCBX4PU3Z6JP");try{console.log(JSON.stringify(e));var n=e.toXDRObject();console.log(JSON.stringify(n));var t=i.Asset.fromOperation(n);console.log(JSON.stringify(t))}catch(e){console.log(e)}}}]),e}();n.a=a},function(e,t){e.exports=n},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=t(0),u=function(){function e(n,t,o){r(this,e),this._serverURL=n,this._testnet=t,this._server=new i.Server(n,o)}return o(e,[{key:"server",value:function(){return this._testnet?i.Network.useTestNetwork():i.Network.usePublicNetwork(),this._server}},{key:"testnet",value:function(){return this._testnet}},{key:"serverURL",value:function(){return this._serverURL}}]),e}();n.a=u}])});